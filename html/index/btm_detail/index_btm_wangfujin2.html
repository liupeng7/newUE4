<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>重点区域详情底部-模块2</title>
    <link rel="stylesheet" href="../../../common/css/index.css">
    <style>
        html{width: 1040px;height: 600px;overflow: hidden;}
        body{height: 100%;display: flex;flex-direction: column;justify-content: center}
        .right{width: 600px;height: 400px;}
        .ring_chart{position: relative}
        .ring_num{position: absolute;top:50%;left:50%;transform: translate(-50%,-50%);font-size: 26px;font-weight: bold}
        .ring_info{margin-left:5px;}
        .ring_info_name{font-size: 26px;}
        .ring_info_value{font-size: 18px;font-weight: normal;margin-top:15px;}
        .ring_info_value span{font-size: 32px;font-weight: bold;}

        .right_ring{display: flex;flex-wrap: wrap}


        .title_street{margin-left:25px}
        .title_street .name{font-size:32px;font-weight:bold;}
        .title_street .location{font-size:24px;    margin-top: 14px;}
        .left_chart_title{font-size:24px;font-weight: bold}
        .left_chart_title div{background: rgba(255, 156, 28, 1);width: 12px;height: 12px;margin:0 5px;}


    /*动画*/
        .left{transition:all  0.6s; transform: translate(440px,0);opacity: 0}
        .left.comeIn{transform:translate(0,0);opacity: 1;}
        .right{width: 600px;height: 400px;transition:all  0.6s 0.2s; transform: translate(600px,0);opacity: 0}
        .right.comeIn{transform:translate(0,0);opacity: 1;}
        .left_title{width: 440px;transition:all  0.6s; transform: translate(300px,0);opacity: 0}
        .left_title.comeIn{transform:translate(0,0);opacity: 1;}
        .left_chart{margin-top:40px;transition:all  0.6s 0.1s; transform: translate(300px,0);opacity: 0}
        .left_chart.comeIn{transform:translate(0,0);opacity: 1;}
        .right_title{font-size: 26px;font-weight: bold;padding-bottom: 20px;margin-top:20px;transition:all  0.6s 0.2s; transform: translate(300px,0);opacity: 0}
        .right_title.comeIn{transform:translate(0,0);opacity: 1;}
        .right_ringItem{width: 300px;margin-top:50px;transition:all  0.6s; transform: translate(300px,0);opacity: 0}
        .right_ringItem.comeIn{transform:translate(0,0);opacity: 1;}
    </style>
</head>

<body oncontextmenu=self.event.returnValue=false>
<div class="flex_bet" >
    <div class="left">
        <div class="left_title flex" >
            <img src="../../../image/index/icon_street_1.png" width="90px" height="100px">
            <div class="title_street">
                <div class="name">王府井百货</div>
                <div class="location">地址：繁华区西戎路108号</div>
            </div>
        </div>
        <div class="left_chart" >
            <div class="left_chart_title flex"><div></div>人流数量预测</div>
            <div id="bar_chart" style="width: 400px;height: 200px;"></div>
        </div>
    </div>
    <div class="right">
        <div class="right_title">重点楼层实时人流</div>
        <div class="right_ring " >
            <div class="right_ringItem flex" style="transition-delay:0.3s">
                <div class="ring_chart">
                    <div class="donut1">
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg"   width="100" height="100" viewBox="0 0 200 200">
                            <circle stroke="rgba(255,255,255,0.5)" stroke-width="10" fill="transparent" r="80" cx="100" cy="100"></circle>
                            <path id="circlePath" d="M 100 20 a 60 60 0 0 1 0 160 a 80 80 90 0 1 0 -160 Z" fill="none" stroke="rgba(255, 50, 23, 1)"
                                  stroke-width="20"  stroke-dasharray="498.54816" >
                                <animate id="circleAnimate" attributeName="stroke-dashoffset" from="498.54816" to="0" dur="3s" repeatDur="" fill="freeze"
                                         begin="0" restart="whenNotActive"></animate>
                            </path>
                        </svg>
                    </div>
                    <div class="ring_num">54%</div>
                </div>
                <div class="ring_info">
                    <div class="ring_info_name">1F · 奢侈品</div>
                    <div class="ring_info_value"><span id="NumScroll1">325</span>人次</div>
                </div>
            </div>
            <div class="right_ringItem flex" style="transition-delay:0.4s">
                <div class="ring_chart">
                    <div class="donut2">
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg"   width="100" height="100" viewBox="0 0 200 200">
                            <circle stroke="rgba(255,255,255,0.5)" stroke-width="10" fill="transparent" r="80" cx="100" cy="100"></circle>
                            <path id="circlePath" d="M 100 20 a 60 60 0 0 1 0 160 a 80 80 90 0 1 0 -160 Z" fill="none" stroke="rgba(255, 126, 12, 1)"
                                  stroke-width="20"  stroke-dasharray="498.54816">
                                <animate id="circleAnimate" attributeName="stroke-dashoffset" from="498.54816" to="0" dur="3s" repeatDur="" fill="freeze" begin="0" restart="whenNotActive"></animate>
                            </path>
                        </svg>
                    </div>
                    <div class="ring_num">39%</div>
                </div>
                <div class="ring_info">
                    <div class="ring_info_name">2F · 女装</div>
                    <div class="ring_info_value"><span id="NumScroll2">302</span>人次</div>
                </div>
            </div>
            <div class="right_ringItem flex" style="transition-delay:0.5s">
                <div class="ring_chart">
                    <div class="donut3">
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg"   width="100" height="100" viewBox="0 0 200 200">
                            <circle stroke="rgba(255,255,255,0.5)" stroke-width="10" fill="transparent" r="80" cx="100" cy="100"></circle>
                            <path id="circlePath" d="M 100 20 a 60 60 0 0 1 0 160 a 80 80 90 0 1 0 -160 Z" fill="none" stroke="rgba(4, 228, 255, 1)"
                                  stroke-width="20"  stroke-dasharray="498.54816">
                                <animate id="circleAnimate" attributeName="stroke-dashoffset" from="498.54816" to="0" dur="3s" repeatDur="" fill="freeze" begin="indefinite" restart="whenNotActive"></animate>
                            </path>
                        </svg>
                    </div>
                    <div class="ring_num">7%</div>
                </div>
                <div class="ring_info">
                    <div class="ring_info_name">3F · 童装/游乐场</div>
                    <div class="ring_info_value"><span id="NumScroll3">264</span>人次</div>
                </div>
            </div>
            <div class="right_ringItem flex" style="transition-delay:0.6s">
                <div class="ring_chart">
                    <div class="donut4">
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg"   width="100" height="100" viewBox="0 0 200 200">
                            <circle stroke="rgba(255,255,255,0.5)" stroke-width="10" fill="transparent" r="80" cx="100" cy="100"></circle>
                            <path id="circlePath" d="M 100 20 a 60 60 0 0 1 0 160 a 80 80 90 0 1 0 -160 Z" fill="none" stroke="rgba(4, 228, 255, 1)"
                                  stroke-width="20"  stroke-dasharray="498.54816">
                                <animate id="circleAnimate" attributeName="stroke-dashoffset" from="498.54816" to="0" dur="3s" repeatDur="" fill="freeze" begin="indefinite" restart="whenNotActive"></animate>
                            </path>
                        </svg>
                    </div>
                    <div class="ring_num">7%</div>
                </div>
                <div class="ring_info">
                    <div class="ring_info_name">4F · 男装</div>
                    <div class="ring_info_value"><span id="NumScroll4">264</span>人次</div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="../../../plugin/echarts.min.js"></script>
<script src="../../../plugin/jquery-3.1.1.min.js"></script>
<script src="../../../common/js/svg.js"></script>
</body>
</html>

<script>
    window.onload = function(){

        if(window.innerWidth == 0){
            window.onresize = function () {
                // BarChart();
                if(window.innerWidth<900){
                    narrow()
                }
            };
        }else if(window.innerWidth<900){
            // BarChart();
            narrow();
        }else if(window.innerWidth>900){
        }


    };


    let dom1 = document.getElementById('NumScroll1');
    let dom2  = document.getElementById('NumScroll2');
    let dom3  = document.getElementById('NumScroll3');
    let dom4  = document.getElementById('NumScroll4');

    let value1 = parseInt(dom1.innerText);
    let value2 = parseInt(dom2.innerText);
    let value3 = parseInt(dom3.innerText);
    let value4 = parseInt(dom4.innerText);

    runAnimate(54,$('.donut1'));
    runAnimate(39,$('.donut2'));
    runAnimate(7,$('.donut3'));
    runAnimate(7,$('.donut4'));



    setInterval(function () {
        runAnimate(54,$('.donut1'));
        runAnimate(39,$('.donut2'));
        runAnimate(7,$('.donut3'));
        runAnimate(7,$('.donut4'));

        let NewValue1 = value1 +Math.floor(Math.random()*4+1);
        let NewValue2 = value2 +Math.floor(Math.random()*4+1);
        let NewValue3 = value3 +Math.floor(Math.random()*4+1);
        let NewValue4 = value4 +Math.floor(Math.random()*4+1);

        numRunFun(value1,NewValue1,dom1);
        numRunFun(value2,value2+5,dom2);
        numRunFun(value3,value3+5,dom3);
        numRunFun(value4,value4+5,dom4);
        value1 = NewValue1;
        value2 = NewValue2;
        value3 = NewValue3;
        value4 = NewValue4;

        BarChart();
    },4000);



    function narrow(){
        let width = $('html').width()*0.25;
        let height = $('html').height()*0.25;
        $('html').css({
            position: 'absolute',
            transform:'scale(0.5)',
            left:-width,
            top:-height
        });
    }

    comeIn();
    function comeIn(){
        BarChart();
        numRunFun(0,325,dom1,2.5);
        numRunFun(0,302,dom2,2.5);
        numRunFun(0,264,dom3,2);
        numRunFun(0,264,dom4,2);
        $('.left').addClass('comeIn');
        $('.right').addClass('comeIn');
        $('.left_title').addClass('comeIn');
        $('.left_chart').addClass('comeIn');
        $('.right_title').addClass('comeIn');
        $('.right_ringItem').addClass('comeIn');
    }

    function goOut() {
        $('.left').removeClass('comeIn');
        $('.right').removeClass('comeIn');
        $('.left_title').removeClass('comeIn');
        $('.left_chart').removeClass('comeIn');
        $('.right_title').removeClass('comeIn');
        $('.right_ringItem').removeClass('comeIn');
    }

    function BarChart() {
        let myChart = echarts.init(document.getElementById('bar_chart'));
        let option = {
            legend:{
                show:false,
            },
            tooltip: {
                trigger:'axis',
            },
            grid: {
                left:20 ,
                right:20 ,
                top:'10%',
                bottom: 0,
                containLabel: true
            },
            color:['#FFC36A'],
            xAxis: {
                type: 'category',
                axisTick: {
                    show: false
                },
                axisLabel: {
                    show: true,
                    interval:5,
                    margin:9,
                    textStyle: {
                        color: 'rgba(255,255,255,0.75)',
                        fontSize: 20,
                        inside: true,
                    }
                },
                axisLine: {
                    show:true,
                    lineStyle:{
                        color:'#88949E',
                        width:4,
                    },
                },
                // boundaryGap:false,
                data: ['00点','01点','02点','03点','04点','05点','06点','07点','08点','09点','010点','11点','12点','13点','14点','15点','16点','17点','18点'
                    ,'19点','20点','21点','22点','23点','24点']
            },
            yAxis: {
                type: 'value',
                axisTick: {
                    show: false
                },
                axisLine: {
                    show: false,
                },
                axisLabel: {
                    show: false,
                },
                splitLine: {
                    show: true,
                    lineStyle:{
                        color:'rgba(255,255,255,0.15)',
                        type:'dashed'
                    }
                },
            },
            series: [
                {
                    name:'人流量预测',
                    type: 'bar',
                    showSymbol:false,
                    itemStyle:{
                        color:function (params) {
                            if(params.dataIndex<13){
                                return new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                    {offset: 0,color:'rgba(255, 126, 12, 1)'},
                                    {offset: 1, color: 'rgba(255, 126, 12, 0.95)'}
                                    ])
                            }else{
                                return  new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                    {offset: 0,color:'rgba(255, 255, 255, 0.4)'},
                                    {offset: 1, color: 'rgba(255, 255, 255, 0.4)'}
                                ])
                            }
                        },
                    },
                    smooth:false,
                    barWidth:9,
                    animationEasing: 'elasticOut',
                    animationDelay: function (idx) {
                        return idx * 50;
                    },
                    data: [18,16,12,14,19,15,9,6,8,12,14,18,16,12,14,19,15,9,6,8,12,14,20,13,15],
                },
            ]
        };
        myChart.clear();
        myChart.setOption(option)
    }


</script>


